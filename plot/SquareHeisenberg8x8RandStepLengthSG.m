% system size: 8x8; method: random step length stochastic gradient
% E0 values
marker_colors{1} = [019, 103, 131]/256;
marker_colors{2} = [255,158,002] / 256;
marker_colors{3} = [251,056,071] / 256;
marker_colors{4} = [131,064,028] / 256;
marker_colors{5} = [075,116,178] / 256;
marker_colors{6} = [107,112,092] / 256;

e0 = [-39.23283334, -38.37242145, -39.23072870, -39.27922948, -39.27669641, -39.28634243, -39.34764705, -39.35195261, -39.38096658, -39.38422749];
% e0 = [-39.23072870, -39.27922948, -39.27669641, -39.28634243, -39.34764705, -39.35195261, -39.38096658, -39.38422749];
e0 = [e0, -39.39991116, -39.39617069, -39.40120298, -39.39809800, -39.40680967, -39.41850188, -39.41606375, -39.42079013, -39.42648472, -39.43595519, -39.43672804, -39.44950648, -39.44846474, -39.45341503, -39.44984362, -39.45762352, -39.45588390, -39.45779562, -39.46261532, -39.46545161, -39.45872226, -39.46271750, -39.46837107, -39.47446410, -39.46943052, -39.47081665, -39.47453239, -39.47821735, -39.47539537, -39.47504891];
e0 = [e0, -39.47734630, -39.48244884, -39.48614588, -39.48005697, -39.49122608, -39.48523559, -39.48906478, -39.48885786, -39.48649123, -39.49690824, -39.49417328, -39.49315902, -39.50041641, -39.49820666, -39.49795931, -39.49355111, -39.49434402, -39.49835716, -39.49698050, -39.50345931, -39.50376643, -39.50256293, -39.50185263, -39.50446596, -39.50491497, -39.50597088, -39.50398736, -39.50782557, -39.51194540, -39.50844846, -39.50517107, -39.51238874, -39.51145471, -39.50618141, -39.50843290, -39.51057229, -39.50914270, -39.51383858, -39.51494889, -39.51378869, -39.51518816, -39.51275606, -39.51420018, -39.51394756, -39.51582253, -39.51615141, -39.51702285, -39.51461033, -39.52070861, -39.52021629, -39.51861506, -39.52101513, -39.52454290, -39.52138985, -39.52018912, -39.52265334, -39.51970372, -39.52447466, -39.52363273, -39.52048514, -39.52470093, -39.52245324, -39.52584832, -39.52027922, -39.52842550, -39.52552791, -39.52570040, -39.52560693, -39.52407180, -39.52735573, -39.52374210, -39.52687990, -39.53168174, -39.52847766, -39.53020302, -39.52926590, -39.52853946, -39.53215060, -39.53294195, -39.53596929, -39.53506557, -39.53058615, -39.53878468, -39.53164438, -39.53312407, -39.53806773, -39.54144941, -39.53581072, -39.53731110, -39.53885263, -39.52918197, -39.54071197, -39.53393963, -39.54452229, -39.54170541, -39.54039758, -39.53588716, -39.54274050, -39.54689332, -39.54644030];
step0_1 = numel(e0);
e0_alpha0_02 = [-39.54723901, -39.54166089, -39.54367311, -39.54309238, -39.54426628, -39.54161360, -39.53825334, -39.53774561, -39.54175716, -39.54629194, -39.54645584, -39.54164196, -39.54759488, -39.54931552, -39.54365785, -39.54746483, -39.54190306, -39.54808095, -39.55118644, -39.54101861, -39.54080521, -39.54106399, -39.54481719, -39.54619681, -39.54650841, -39.54645743, -39.54280384, -39.54944700, -39.55080310, -39.54702225];
% below alpha = 0.2
e0 = [e0, -39.54723901, -39.54304244, -39.54300932, -39.54100589, -39.54581441, -39.55005797, -39.54637264, -39.54920454, -39.54838482, -39.55078470, -39.55101662, -39.55123290, -39.55513545, -39.55122049, -39.55184600, -39.55632095, -39.55170842, -39.55242193, -39.55501778, -39.55558998, -39.55287455, -39.55580989, -39.55161489, -39.56295160, -39.56317327, -39.55443403, -39.55796688, -39.56320888, -39.56310003, -39.56223625];
alpha0_3_start = numel(e0) + 1;
e0_alpha0_3= [-39.56574560, -39.56504239, -39.54242221, -39.35735690, -39.55209413, -39.45341547, -39.45786039, -38.72801826, -38.60462486, -39.36749827, -39.31933001, -39.51069133, -39.55493771, -39.55929111, -39.52731169, -39.56813502, -39.47787511, -39.27199532, -39.52421266, -39.28969613, -39.56146802, -39.59541096, -39.59374036, -39.59166751, -39.59230512, -39.58175805, -39.57881959, -39.43948045, -38.97162295, -38.28016839];
e0 = [e0, -39.56574560, -39.56333284, -39.56947546, -39.57018318, -39.57148015, -39.57306139, -39.57009035, -39.57486158, -39.57407561, -39.57107098, -39.57265261, -39.57649457, -39.57575258, -39.57406056, -39.57694432, -39.57721903, -39.57908147, -39.58095062, -39.58044010, -39.57591945, -39.57903665, -39.58071696, -39.58202968, -39.58925075, -39.58467082, -39.58724990, -39.58669581, -39.58434075, -39.59211888, -39.58301117, -39.58551352, -39.59152892, -39.58641737, -39.59420150, -39.59835489, -39.60356414, -39.59815751, -39.59751944, -39.59694991, -39.59794832, -39.59858985, -39.60164407, -39.60057398, -39.60047596, -39.59852480, -39.60247850, -39.60314337, -39.60787071, -39.60289988, -39.60820376, -39.60315113, -39.60421606, -39.60866709, -39.60259880, -39.60811842, -39.59889820, -39.60932425, -39.60865197, -39.61385948, -39.60945050];
e0 = [e0, -39.60950894, -39.61231795, -39.60656992, -39.60732678, -39.60967978, -39.61117386, -39.61356437, -39.61057583, -39.61209719, -39.61130961, -39.61141832, -39.61405695, -39.61120838, -39.61217437, -39.60933079, -39.61571415, -39.61206941, -39.60858054, -39.61271363, -39.61645896, -39.61183540, -39.61239944, -39.61498146, -39.61157660, -39.61176639, -39.61750032, -39.61184940, -39.61242650, -39.61384673, -39.61329322];
changeD= numel(e0);
e0 = [e0,-39.57317083, -39.57514886, -39.58006025, -39.58155797, -39.58128330, -39.57969181, -39.58122433, -39.57952793, -39.58228305, -39.58161808, -39.58281203, -39.58329699, -39.58613734, -39.58381272, -39.58345882, -39.58370292, -39.58791953, -39.58457529, -39.58450336, -39.58576119, -39.58605355, -39.58747272, -39.58935396, -39.58793156, -39.58456881, -39.59015504, -39.58971679, -39.58844365, -39.58769309, -39.59030115];
e0 =[e0, -39.58920642, -39.59078996, -39.59161839, -39.58917433, -39.59029993, -39.58968236, -39.58790843, -39.58999994, -39.59266510, -39.59267446, -39.59227254, -39.58880830, -39.59508055, -39.59113980, -39.59143176, -39.59232683, -39.59418640, -39.59349828, -39.59498524, -39.59638638, -39.59327131, -39.59432903, -39.59519831, -39.59435916, -39.59314362, -39.59204967, -39.59405580, -39.59423162, -39.59459233, -39.59647122, -39.59504731, -39.59856070, -39.59645338, -39.59717258, -39.60064436, -39.59445703, -39.59570026, -39.59712331, -39.59936546, -39.59487811, -39.59667568, -39.59773593, -39.59942231, -39.59646853, -39.59750229, -39.59848137, -39.59687158, -39.59813642, -39.59740408, -39.60190981];
e0_persite = e0 / 64;

e0_sr = [-39.34391370, -38.97574491, -39.44059668, -39.46674138, -39.48657151, -39.49985536, -39.51153599, -39.52247198, -39.53776290, -39.55132012, -39.55421196, -39.56475011, -39.56519432, -39.57245795, -39.57863968, -39.57890284, -39.58674243, -39.59028720, -39.59344337, -39.59681992, -39.60012813, -39.60109674, -39.60444125, -39.60573814, -39.60862467, -39.60953946, -39.61012654, -39.61265361, -39.61132442, -39.61314013, -39.61387561, -39.61409884, -39.61740558, -39.61701886, -39.61716946, -39.61712499, -39.61717382, -39.61700063, -39.61758360, -39.61861790, -39.61825641, -39.61826609, -39.61827481, -39.61968025, -39.61828868, -39.61901487, -39.61890123, -39.62004905, -39.61962045];

e0_ex = -0.619040;
% Plotting the data
% plot(e0_persite, 'o', 'LineWidth', 2);
% hold on
% yline(-0.619040, 'r--', 'QMC','fontsize',18);

semilogy((e0_persite -e0_ex)/abs(e0_ex), 'o','LineWidth', 2); hold on;
h1 = semilogy(alpha0_3_start:alpha0_3_start+numel(e0_alpha0_3)-1, (e0_alpha0_3/64-e0_ex)/abs(e0_ex),'o','LineWidth',2);
h2 = semilogy(step0_1+1:step0_1+numel(e0_alpha0_02), (e0_alpha0_02/64-e0_ex)/abs(e0_ex),'o','LineWidth',2);

h3 = semilogy((e0_sr/64 - e0_ex)/abs(e0_ex),  'x','LineWidth', 2)
xline(step0_1, 'b--');
xline(changeD, 'b--');

T=text(20,0.02,['For SG: $8\times 8$, PEPS $D=8$', char(10),...
                'Boundary MPS $\chi=8$', char(10),...
                '$\alpha = 0.1$', char(10),...
                'Samples = 56 chains $\times 1000$.']);
set(T,'Interpreter','latex');
set(T,'Fontsize',18);

T2=text(150,1e-4,['change $\alpha = 0.2$']);
set(T2,'Interpreter','latex');
set(T2,'Fontsize',18);

T2=text(280,1e-4,['Increase $\chi=12$', char(10),...
                   'Samples = 56 chains $\times 2000$.']);
set(T2,'Interpreter','latex');
set(T2,'Fontsize',18);

l=legend([h2, h1, h3], {'$\alpha = 0.02$', '$\alpha = 0.3$','SR, $\chi = 16$, sample = $56\times 500, \alpha = 0.4$'});
set(l,'Box','off');set(l,'Interpreter','latex');
set(l,'Fontsize',24);
set(l,'Location','SouthWest');

xlabel('Iteration','Interpreter','latex')
% ylabel('Persite energy $e_0$','Interpreter','latex')
ylabel('energy relative error','Interpreter','latex')
set(gca,'fontsize',24);
set(gca,'linewidth',1.5);
set(get(gca,'Children'),'linewidth',2); % Set line width 1.5 pounds
set(get(gca,'XLabel'),'FontSize',24);
set(get(gca,'YLabel'),'FontSize',24);
set(gcf, 'position',  [100, 100, 1300, 600]);
hold off;

figure_directory = './';
figure_name_eps = 'EnergyDecreasingHeisenberg.eps';
figure_path = fullfile(figure_directory, figure_name_eps);
saveas(gcf, figure_path, 'epsc');
disp(['Energy deceasing of the heisenberg model: ', figure_path]);